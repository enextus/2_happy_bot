<!DOCTYPE html>

<html>
<head>
<meta charset="UTF-8">

<title>README - cli 1.3.1</title>

<script type="text/javascript">
  var rdoc_rel_prefix = "./";
  var index_rel_prefix = "./";
</script>

<script src="./js/navigation.js" defer></script>
<script src="./js/search.js" defer></script>
<script src="./js/search_index.js" defer></script>
<script src="./js/searcher.js" defer></script>
<script src="./js/darkfish.js" defer></script>

<link href="./css/fonts.css" rel="stylesheet">
<link href="./css/rdoc.css" rel="stylesheet">


<body id="top" role="document" class="file">
<nav role="navigation">
  <div id="project-navigation">
    <div id="home-section" role="region" title="Quick navigation" class="nav-section">
  <h2>
    <a href="./index.html" rel="home">Home</a>
  </h2>

  <div id="table-of-contents-navigation">
    <a href="./table_of_contents.html#pages">Pages</a>
    <a href="./table_of_contents.html#classes">Classes</a>
    <a href="./table_of_contents.html#methods">Methods</a>
  </div>
</div>

    <div id="search-section" role="search" class="project-section initially-hidden">
  <form action="#" method="get" accept-charset="utf-8">
    <div id="search-field-wrapper">
      <input id="search-field" role="combobox" aria-label="Search"
             aria-autocomplete="list" aria-controls="search-results"
             type="text" name="search" placeholder="Search" spellcheck="false"
             title="Type to search, Up and Down to navigate, Enter to load">
    </div>

    <ul id="search-results" aria-label="Search Results"
        aria-busy="false" aria-expanded="false"
        aria-atomic="false" class="initially-hidden"></ul>
  </form>
</div>

  </div>

  
<div class="nav-section">
  <h3>Table of Contents</h3>

  <ul class="link-list" role="directory">
    <li><a href="#label-CLI">CLI</a>
    <li><a href="#label-Installing">Installing</a>
    <li><a href="#label-Examples">Examples</a>
    <li><a href="#label-HTTPClient+example">HTTPClient example</a>
    <li><a href="#label-Sinatra+server+example">Sinatra server example</a>
    <li><a href="#label-Statistic+data+processor+example">Statistic data processor example</a>
    <li><a href="#label-Ls+like+utility">Ls like utility</a>
    <li><a href="#label-Usage">Usage</a>
    <li><a href="#label-23parse+method"><code>#parse</code> method</a>
    <li><a href="#label-23parse-21+method"><code>#parse!</code> method</a>
    <li><a href="#label-Parser+behavior+specifiers">Parser behavior specifiers</a>
    <li><a href="#label-description+-27string-27">description ‘string’</a>
    <li><a href="#label-version+-27string-27">version ‘string’</a>
    <li><a href="#label-switch+-3Aname+-5B-2C+options+hash-5D">switch :name [, options hash]</a>
    <li><a href="#label-option+-3Aname+-5B-2C+options+hash-5D">option :name [, options hash]</a>
    <li><a href="#label-options+-3Aname+-5B-2C+options+hash-5D">options :name [, options hash]</a>
    <li><a href="#label-argument+-3Aname+-5B-2Coptions+hash-5D">argument :name [,options hash]</a>
    <li><a href="#label-arguments+-3Aname+-5B-2Coptions+hash-5D">arguments :name [,options hash]</a>
    <li><a href="#label-stdin+-3Aname-2C+-5Boptions+hash-5D">stdin :name, [options hash]</a>
    <li><a href="#label-Contributing+to+CLI">Contributing to CLI</a>
    <li><a href="#label-Copyright">Copyright</a>
  </ul>
</div>


  <div id="project-metadata">
    
<div id="fileindex-section" class="nav-section">
  <h3>Pages</h3>

  <ul class="link-list">
    <li><a href="./README_md.html">README</a>
  </ul>
</div>

  </div>
</nav>

<main role="main" aria-label="Page README.md">

<h1 id="label-CLI"><a href="CLI.html"><code>CLI</code></a><span><a href="#label-CLI">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>Command Line Interface gem allows you to quickly specify command argument parser that will automatically generate usage, handle stdin, switches, options and arguments with default values and value casting.</p>

<h2 id="label-Installing">Installing<span><a href="#label-Installing">&para;</a> <a href="#top">&uarr;</a></span></h2>

<pre class="ruby"><span class="ruby-identifier">gem</span> <span class="ruby-identifier">install</span> <span class="ruby-identifier">cli</span>
</pre>

<h2 id="label-Examples">Examples<span><a href="#label-Examples">&para;</a> <a href="#top">&uarr;</a></span></h2>

<h3 id="label-HTTPClient+example">HTTPClient example<span><a href="#label-HTTPClient+example">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>The following example shows basic usage of the <a href="CLI.html"><code>CLI</code></a> gem. It will use HTTPClient to connect to server that address and port can be specified with <code>--server</code> and <code>--port</code> switches. It expects at least one argument specifying the URL (that needs to start with <code>/</code>) and optional set of POST arguments.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;rubygems&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;cli&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;httpclient&#39;</span>

<span class="ruby-identifier">settings</span> = <span class="ruby-constant">CLI</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
    <span class="ruby-identifier">option</span> <span class="ruby-value">:server</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;server address&#39;</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;www.google.com&#39;</span>
    <span class="ruby-identifier">option</span> <span class="ruby-value">:port</span>,       <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;server port&#39;</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">80</span>
    <span class="ruby-identifier">argument</span> <span class="ruby-value">:url</span>,      <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;URL to GET or POST to if arguments are given&#39;</span>
    <span class="ruby-identifier">arguments</span> <span class="ruby-value">:post_arguments</span>, <span class="ruby-value">:required</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">false</span>
<span class="ruby-keyword">end</span>.<span class="ruby-identifier">parse!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">settings</span><span class="ruby-operator">|</span>
    <span class="ruby-identifier">fail</span> <span class="ruby-node">&quot;invalid URL &#39;#{settings.url}&#39;, URL has to start with &#39;/&#39;&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">url</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/^\//</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">c</span> = <span class="ruby-constant">HTTPClient</span>.<span class="ruby-identifier">new</span>

<span class="ruby-keyword">begin</span>
    <span class="ruby-keyword">if</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">post_arguments</span>.<span class="ruby-identifier">empty?</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">get_async</span>(<span class="ruby-node">&quot;http://#{settings.server}:#{settings.port}#{settings.url}&quot;</span>).<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">read</span>
    <span class="ruby-keyword">else</span>
        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">c</span>.<span class="ruby-identifier">post_async</span>(<span class="ruby-node">&quot;http://#{settings.server}:#{settings.port}#{settings.url}&quot;</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">post_arguments</span>.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)).<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">content</span>.<span class="ruby-identifier">read</span>
    <span class="ruby-keyword">end</span> 
<span class="ruby-keyword">rescue</span> <span class="ruby-constant">SocketError</span>, <span class="ruby-constant">Errno</span><span class="ruby-operator">::</span><span class="ruby-constant">ECONNREFUSED</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
    <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;Failed to connect: #{e}&quot;</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Example usage with default server:</p>

<pre>examples/httpclient /index.html</pre>

<p>The output will contain Google website.</p>

<p>Using different server:</p>

<pre>examples/httpclient --server ibm.com /index.html</pre>

<p>When run without arguments:</p>

<pre class="ruby"><span class="ruby-identifier">examples</span><span class="ruby-operator">/</span><span class="ruby-identifier">httpclient</span>
</pre>

<p>The following message will be printed and the program will exit (status 42):</p>

<pre>Error: mandatory argument &#39;url&#39; not given
Usage: httpclient [switches|options] [--] url [post-arguments*]
Switches:
   --help (-h) - display this help message
Options:
   --server [www.google.com] - server address
   --port [80] - server port
Arguments:
   url - URL to GET or POST to if arguments are given
   post-arguments* (optional)</pre>

<p>When used with command that does not start with <code>/</code>:</p>

<pre>examples/httpclient test</pre>

<p>It will print the following message and exit:</p>

<pre>Error: invalid URL &#39;test&#39;, URL has to start with &#39;/&#39;
Usage: httpclient [switches|options] [--] url [post-arguments*]
Switches:
   --help (-h) - display this help message
Options:
   --server [www.google.com] - server address
   --port [80] - server port
Arguments:
   url - URL to GET or POST to if arguments are given
   post-arguments* (optional)</pre>

<h3 id="label-Sinatra+server+example">Sinatra server example<span><a href="#label-Sinatra+server+example">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;rubygems&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;cli&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;ip&#39;</span>

<span class="ruby-identifier">settings</span> = <span class="ruby-constant">CLI</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">description</span> <span class="ruby-string">&#39;Example CLI usage for Sinatra server application&#39;</span>
        <span class="ruby-identifier">version</span> <span class="ruby-string">&quot;1.0.0&quot;</span>
        <span class="ruby-identifier">switch</span> <span class="ruby-value">:no_bind</span>,                        <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Do not bind to TCP socket - useful with -s fastcgi option&quot;</span>
        <span class="ruby-identifier">switch</span> <span class="ruby-value">:no_logging</span>,                     <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Disable logging&quot;</span>
        <span class="ruby-identifier">switch</span> <span class="ruby-value">:debug</span>,                          <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Enable debugging&quot;</span>
        <span class="ruby-identifier">switch</span> <span class="ruby-value">:no_optimization</span>,        <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Disable size hinting and related optimization (loading, prescaling)&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:bind</span>,                           <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:b</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;127.0.0.1&#39;</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">IP</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;HTTP server bind address - use 0.0.0.0 to bind to all interfaces&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:port</span>,                           <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:p</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">3100</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;HTTP server TCP port&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:server</span>,                         <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:s</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;mongrel&#39;</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Rack server handler like thin, mongrel, webrick, fastcgi etc.&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:limit_memory</span>,           <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">128</span><span class="ruby-operator">*</span><span class="ruby-value">1024</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Image cache heap memory size limit in bytes&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:limit_map</span>,                      <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">256</span><span class="ruby-operator">*</span><span class="ruby-value">1024</span><span class="ruby-operator">**</span><span class="ruby-value">2</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Image cache memory mapped file size limit in bytes - used when heap memory limit is used up&quot;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:limit_disk</span>,                     <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&quot;Image cache temporary file size limit in bytes - used when memory mapped file limit is used up&quot;</span>
<span class="ruby-keyword">end</span>.<span class="ruby-identifier">parse!</span>

<span class="ruby-comment"># use to set sinatra settings</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;sinatra/base&#39;</span>

<span class="ruby-identifier">sinatra</span> = <span class="ruby-constant">Sinatra</span>.<span class="ruby-identifier">new</span>

<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:environment</span>, <span class="ruby-string">&#39;production&#39;</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:server</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">server</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:lock</span>, <span class="ruby-keyword">true</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:boundary</span>, <span class="ruby-string">&quot;thumbnail image data&quot;</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:logging</span>, (<span class="ruby-keyword">not</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">no_logging</span>)
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:debug</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">debug</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:optimization</span>, (<span class="ruby-keyword">not</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">no_optimization</span>)
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:limit_memory</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">limit_memory</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:limit_map</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">limit_map</span>
<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">set</span> <span class="ruby-value">:limit_disk</span>, <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">limit_disk</span>

<span class="ruby-comment"># set up your application</span>

<span class="ruby-identifier">sinatra</span>.<span class="ruby-identifier">run!</span>
</pre>

<p>To see help message use <code>--help</code> or <code>-h</code> anywhere on the command line:</p>

<pre>examples/sinatra --help</pre>

<p>Example help message:</p>

<pre>Usage: sinatra [switches|options]
Example CLI usage for Sinatra server application
Switches:
   --no-bind - Do not bind to TCP socket - useful with -s fastcgi option
   --no-logging - Disable logging
   --debug - Enable debugging
   --no-optimization - Disable size hinting and related optimization (loading, prescaling)
   --help (-h) - display this help message
   --version - display version string
Options:
   --bind (-b) [127.0.0.1] - HTTP server bind address - use 0.0.0.0 to bind to all interfaces
   --port (-p) [3100] - HTTP server TCP port
   --server (-s) [mongrel] - Rack server handler like thin, mongrel, webrick, fastcgi etc.
   --limit-memory [134217728] - Image cache heap memory size limit in bytes
   --limit-map [268435456] - Image cache memory mapped file size limit in bytes - used when heap memory limit is used up
   --limit-disk [0] - Image cache temporary file size limit in bytes - used when memory mapped file limit is used up</pre>

<p>To see version string use <code>--version</code></p>

<pre>examples/sinatra --version</pre>

<p>Example version output:</p>

<pre class="ruby"><span class="ruby-identifier">sinatra</span> <span class="ruby-identifier">version</span> <span class="ruby-string">&quot;0.0.4&quot;</span>
</pre>

<h3 id="label-Statistic+data+processor+example">Statistic data processor example<span><a href="#label-Statistic+data+processor+example">&para;</a> <a href="#top">&uarr;</a></span></h3>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;rubygems&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;cli&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;pathname&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;yaml&#39;</span>

<span class="ruby-identifier">settings</span> = <span class="ruby-constant">CLI</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">description</span> <span class="ruby-string">&#39;Generate blog posts in given Jekyll directory from input statistics&#39;</span>
        <span class="ruby-identifier">stdin</span> <span class="ruby-value">:log_data</span>,        <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">YAML</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;statistic data in YAML format&#39;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:location</span>,       <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:l</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;location name (ex. Dublin, Singapore, California)&#39;</span>
        <span class="ruby-identifier">option</span> <span class="ruby-value">:csv_dir</span>,        <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:c</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Pathname</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;csv&#39;</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;directory name where CSV file will be stored (relative to jekyll-dir)&#39;</span>
        <span class="ruby-identifier">argument</span> <span class="ruby-value">:jekyll_dir</span>,   <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Pathname</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;/var/lib/vhs/jekyll&#39;</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;directory where site source is located&#39;</span>
<span class="ruby-keyword">end</span>.<span class="ruby-identifier">parse!</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">settings</span><span class="ruby-operator">|</span>
        <span class="ruby-identifier">fail</span> <span class="ruby-string">&#39;jekyll-dir is not a directory&#39;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">jekyll_dir</span>.<span class="ruby-identifier">directory?</span>
        <span class="ruby-identifier">fail</span> <span class="ruby-string">&#39;--csv-dir is not a directory (relative to jekyll-dir)&#39;</span> <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">settings</span>.<span class="ruby-identifier">jekyll_dir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">csv_dir</span>).<span class="ruby-identifier">directory?</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">p</span> <span class="ruby-identifier">settings</span>

<span class="ruby-comment"># do your stuff</span>
</pre>

<p>Example help message:</p>

<pre>Usage: processor [switches|options] [--] [jekyll-dir] &lt; log-data
Generate blog posts in given Jekyll directory from input statistics
Input:
   log-data - statistic data in YAML format
Switches:
   --help (-h) - display this help message
Options:
   --location (-l) - location name (ex. Dublin, Singapore, California)
   --csv-dir (-c) [csv] - directory name where CSV file will be stored (relative to jekyll-dir)
Arguments:
   jekyll-dir [/var/lib/vhs/jekyll] - directory where site source is located</pre>

<p>With this example usage (assuming /var/lib/vhs/jekyll/csv dir exist):</p>

<pre>examples/processor --location Singapore &lt;&lt;EOF
:parser: 
  :successes: 41
  :failures: 0
EOF</pre>

<p>The <code>settings</code> variable will contain:</p>

<pre class="ruby"><span class="ruby-comment">#&lt;CLI::Values stdin={:parser=&gt;{:successes=&gt;41, :failures=&gt;0}}, jekyll_dir=#&lt;Pathname:/var/lib/vhs/jekyll&gt;, csv_dir=#&lt;Pathname:csv&gt;, help=nil, location=&quot;Singapore&quot;&gt;</span>
</pre>

<p>Output if jekyll-dir does not exist:</p>

<pre>Error: jekyll-dir is not a directory
Usage: processor [switches|options] [--] [jekyll-dir] &lt; log-data
Generate blog posts in given Jekyll directory from input statistics
Input:
   log-data - statistic data in YAML format
Switches:
   --help (-h) - display this help message
Options:
   --location (-l) - location name (ex. Dublin, Singapore, Califorina)
   --csv-dir (-c) [csv] - directory name where CSV file will be storred (relative to jekyll-dir)
Arguments:
   jekyll-dir [/var/lib/vhs/jekyll] - directory where site source is located</pre>

<h3 id="label-Ls+like+utility">Ls like utility<span><a href="#label-Ls+like+utility">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p><code>arguments</code> specifier can be used to match multiple arguments. The <code>arguments</code> specifier matched value will always be an array of casted elements. Default and mandatory arguments will have priority on matching values (see specs for examples).</p>

<p><code>options</code> specifier can be used to allow specifing same option multiple times. The <code>options</code> specifier matched value will always be an array of casted elements or empty if option not specified.</p>

<pre class="ruby"><span class="ruby-identifier">require</span> <span class="ruby-string">&#39;rubygems&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;cli&#39;</span>
<span class="ruby-identifier">require</span> <span class="ruby-string">&#39;pathname&#39;</span>

<span class="ruby-identifier">settings</span> = <span class="ruby-constant">CLI</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword">do</span>
        <span class="ruby-identifier">description</span> <span class="ruby-string">&#39;Lists content of directories&#39;</span>
        <span class="ruby-identifier">switch</span> <span class="ruby-value">:long</span>, <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:l</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;use long listing&#39;</span>
        <span class="ruby-identifier">options</span> <span class="ruby-value">:exclude</span>, <span class="ruby-value">:short</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">:e</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;exclude files from listing&#39;</span>
        <span class="ruby-identifier">arguments</span> <span class="ruby-value">:directories</span>, <span class="ruby-value">:cast</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Pathname</span>, <span class="ruby-value">:default</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;.&#39;</span>, <span class="ruby-value">:description</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-string">&#39;directories to list content of&#39;</span>
<span class="ruby-keyword">end</span>.<span class="ruby-identifier">parse!</span>

<span class="ruby-identifier">settings</span>.<span class="ruby-identifier">directories</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">dir</span><span class="ruby-operator">|</span>
        <span class="ruby-keyword">next</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">directory?</span>
        <span class="ruby-identifier">dir</span>.<span class="ruby-identifier">each_entry</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">e</span><span class="ruby-operator">|</span>
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;.&#39;</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-string">&#39;..&#39;</span>
                <span class="ruby-identifier">e</span> = <span class="ruby-identifier">dir</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">exclude</span>.<span class="ruby-identifier">include?</span> <span class="ruby-identifier">e</span>.<span class="ruby-identifier">to_s</span>
                <span class="ruby-keyword">if</span> <span class="ruby-identifier">settings</span>.<span class="ruby-identifier">long</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-node">&quot;#{e.stat.uid}:#{e.stat.gid} #{e}&quot;</span>
                <span class="ruby-keyword">else</span>
                        <span class="ruby-identifier">puts</span> <span class="ruby-identifier">e</span>
                <span class="ruby-keyword">end</span>
        <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>Example help message:</p>

<pre>Usage: ls [switches|options] [--] [directories*]
Lists content of directories
Switches:
   --long (-l) - use long listing
   --help (-h) - display this help message
Options:
   --exclude* (-e) - exclude files from listing
Arguments:
   directories* [.] - directories to list content of</pre>

<p>Example usage:</p>

<pre class="ruby"><span class="ruby-identifier">examples</span><span class="ruby-operator">/</span><span class="ruby-identifier">ls</span>
</pre>

<p>Prints:</p>

<pre>.document
.git
.gitignore
.README.md.swp
.rspec
cli.gemspec
examples
features
...</pre>

<p>Excluding .git and .gitignore:</p>

<pre>examples/ls -e .git -e .gitignore</pre>

<p>Prints:</p>

<pre>.document
.README.md.swp
.rspec
cli.gemspec
examples
features
...</pre>

<p>With directory list:</p>

<pre>examples/ls *</pre>

<p>Prints:</p>

<pre>examples/.ls.swp
examples/ls
examples/processor
examples/sinatra
features/cli.feature
features/step_definitions
features/support
lib/cli
lib/cli.rb
pkg/cli-0.0.1.gem
pkg/cli-0.0.2.gem
...</pre>

<p>Long printout:</p>

<pre>examples/ls -l *</pre>

<p>Prints:</p>

<pre>501:20 examples/.ls.swp
501:20 examples/ls
501:20 examples/processor
501:20 examples/sinatra
501:20 features/cli.feature
501:20 features/step_definitions
501:20 features/support
501:20 lib/cli
501:20 lib/cli.rb
501:20 pkg/cli-0.0.1.gem
501:20 pkg/cli-0.0.2.gem
...</pre>

<h2 id="label-Usage">Usage<span><a href="#label-Usage">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p><code>CLI.new</code> takes a block where you specify parser behavior. The returned object is a parser that has <code>#parse</code> and <code>#parse!</code> methods.</p>

<h3 id="label-23parse+method"><code>#parse</code> method<span><a href="#label-23parse+method">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>It will take argument array (defaults to ARGV), standard input IO (defaults to STDIO) and standard error IO (defaults to STDERR).</p>

<p>The method will parse argument array and cast standard input IO according to parser specification and return OpenStruct kind of object with resulting values.</p>

<p>The returned object will have <code>help</code> attribute set if <code>--help</code> or <code>-h</code> switch was found in argument array or <code>version</code> attribute if <code>--version</code> argument was found. In other case all the attributes will be set to appropriate values depending on argument array and parser specification. In case of parsing error <code>CLI::ParsingError</code> kind of exception will be raised.</p>

<h3 id="label-23parse-21+method"><code>#parse!</code> method<span><a href="#label-23parse-21+method">&para;</a> <a href="#top">&uarr;</a></span></h3>

<p>This is higher level version of <code>#parse</code> method that will exit the program and print out usage if there was parsing error. Also it will display usage on <code>--help</code> or <code>-h</code> switch and version string on <code>--version</code> switch found in argument array.</p>

<p>In other case it will return OpenStruct object from <code>#parse</code> method.</p>

<p>Additionally this method can be called with a block that will get the OpenStruct like object before returning it. This block should contain additional value verifications and if it raises RuntimeError (via <code>fail</code> method for instance) the error message will be displayed followed by usage and the program will exit.</p>

<h3 id="label-Parser+behavior+specifiers">Parser behavior specifiers<span><a href="#label-Parser+behavior+specifiers">&para;</a> <a href="#top">&uarr;</a></span></h3>

<h4 id="label-description+-27string-27">description ‘string’<span><a href="#label-description+-27string-27">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <em>string</em> will be displayed in usage output as your program short description.</p>

<h4 id="label-version+-27string-27">version ‘string’<span><a href="#label-version+-27string-27">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>The <em>string</em> representing program version that will be displayed when <code>--version</code> switch is used</p>

<h4 id="label-switch+-3Aname+-5B-2C+options+hash-5D">switch :name [, options hash]<span><a href="#label-switch+-3Aname+-5B-2C+options+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>When switch is specified in the command argument list the object returned by <code>#parse</code> or <code>#parse!</code> will contain argument of same name set to <code>true</code>. Otherwise the argument value will be <code>nil</code>.</p>

<p><em>:name</em> should be a symbol that will map to long switch (<code>--name</code>) where underscore (<code>_</code>) will be replaced with minus (<code>-</code>). Name has to be unique.</p>

<p>Option hash can contain following pairs:</p>
<ul><li>
<p><strong>:short =&gt; :symbol</strong> - where <em>:symbol</em> is a single letter symbol that will represent short switch name (<code>-n</code>). Short name has to be unique.</p>
</li><li>
<p><strong>:description =&gt; ‘string’</strong> - switch description string that will be displayed in the usage output</p>
</li></ul>

<h4 id="label-option+-3Aname+-5B-2C+options+hash-5D">option :name [, options hash]<span><a href="#label-option+-3Aname+-5B-2C+options+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Same as <em>switch</em> but additionally it has to be followed by a value on the command argument list. The value after casting (if used) will be available from the <code>#parse</code> or <code>#parse!</code> returned object as argument of the same name.</p>

<p>In addition to <em>switch</em>, option hash can have following pairs:</p>
<ul><li>
<p><strong>:default =&gt; value</strong> - use default value of <em>value</em> if the option was not specified on the command argument list. The <em>value</em> will firstly be casted to string (with <code>#to_s</code>) and then it will be casted if casting is specified.</p>
</li><li>
<p><strong>:default_label =&gt; label</strong> - display <em>label</em> in usage rather than default value - useful to describe default value if default value is generated if no value is provided</p>
</li><li>
<p><strong>:cast =&gt; cast specifier</strong> - cast the provided value (or default) with given <em>cast specifier</em>. The specifier can be a class constant - the value will be provided to <code>#new</code> method of the class and resulting object used as option value. When provided constant does not respond to <code>#new</code> (i.e. it is a module) the <code>#load</code> method will be tried instead. If provided specifier is a Proc (or <code>lambda {}</code>) the Proc will be called with the value and resulting value will be used. Otherwise <code>CLI::ParsingError::CastError</code> will be raised. Special cast specified <code>Integer</code> or <code>Float</code> can also be used - the value will be strictly casted to integer or float type.</p>
</li><li>
<p><strong>:required =&gt; true</strong> - if used and no <em>default</em> value is specified the <code>#parse</code> method will fail with <code>CLI::ParsingError::MissingOptionValueError</code> if the option was not specified in the command argument list. If <code>#parse!</code> method was used the program will exit with appropriate message.</p>
</li></ul>

<h4 id="label-options+-3Aname+-5B-2C+options+hash-5D">options :name [, options hash]<span><a href="#label-options+-3Aname+-5B-2C+options+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Same as <em>option</em> but can be specified multiple times in the command argument list. The resulting <code>#parse</code> or <code>#parse!</code> returned object will contain an argument with the same name that will always be an array. The array may be empty if the option was not used and <em>required</em> option was not set, otherwise it will contain casted values in order of specification in the command argument list.</p>

<h4 id="label-argument+-3Aname+-5B-2Coptions+hash-5D">argument :name [,options hash]<span><a href="#label-argument+-3Aname+-5B-2Coptions+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>After the parser encounters command line argument that is not a <em>switch</em> or <em>option</em> or it is literally <code>--</code> string it will start matching arguments.</p>

<p>Each argument will be matched to argument specifications in order and their value after optional casting will be available as <code>#parse</code> or <code>#parse!</code> returned object argument with the same name.</p>

<p>Options hash can contain the same pairs as <em>option</em> expect of <strong>:short =&gt; :symbol</strong>.</p>

<p>If defaults are used the parser will keep using default values until it has enough command line arguments available to fill all mandatory arguments. Arguments are required by default, use <strong>:required =&gt; false</strong> option pair to use <code>nil</code> value if argument is not specified on the command line argument list.</p>

<h4 id="label-arguments+-3Aname+-5B-2Coptions+hash-5D">arguments :name [,options hash]<span><a href="#label-arguments+-3Aname+-5B-2Coptions+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Same as <em>argument</em> but will match one or more arguments and provide them in array of casted values. If argument is not required and not specified in command argument list then its value will be an empty array.</p>

<p>When used with <em>argument</em> specifiers that use default values the parser will try to assign at least one value to this specifier, but not more values so that all mandatory (that have no default and are required) arguments will be assigned.</p>

<h4 id="label-stdin+-3Aname-2C+-5Boptions+hash-5D">stdin :name, [options hash]<span><a href="#label-stdin+-3Aname-2C+-5Boptions+hash-5D">&para;</a> <a href="#top">&uarr;</a></span></h4>

<p>Used once to specify that stdin should be handled. When used the <code>#parse</code> or <code>#parse!</code> returned object will have <code>stdin</code> argument that by default will contain stdin IO object.</p>

<p>As with <em>switch</em> specifier the <strong>:description =&gt; ‘string’</strong> can be used. Also <strong>:cast =&gt; cast specifier</strong> option pair can be used but the value will be an IO object and not string.</p>

<h2 id="label-Contributing+to+CLI">Contributing to <a href="CLI.html"><code>CLI</code></a><span><a href="#label-Contributing+to+CLI">&para;</a> <a href="#top">&uarr;</a></span></h2>
<ul><li>
<p>Check out the latest master to make sure the feature hasn’t been implemented or the bug hasn’t been fixed yet</p>
</li><li>
<p>Check out the issue tracker to make sure someone already hasn’t requested it and/or contributed it</p>
</li><li>
<p>Fork the project</p>
</li><li>
<p>Start a feature/bugfix branch</p>
</li><li>
<p>Commit and push until you are happy with your contribution</p>
</li><li>
<p>Make sure to add tests for it. This is important so I don’t break it in a future version unintentionally.</p>
</li><li>
<p>Please try not to mess with the Rakefile, version, or history. If you want to have your own version, or is otherwise necessary, that is fine, but please isolate to its own commit so I can cherry-pick around it.</p>
</li></ul>

<h2 id="label-Copyright">Copyright<span><a href="#label-Copyright">&para;</a> <a href="#top">&uarr;</a></span></h2>

<p>Copyright © 2011 Jakub Pastuszek. See LICENSE.txt for further details.</p>

</main>



<footer id="validator-badges" role="contentinfo">
  <p><a href="https://validator.w3.org/check/referer">Validate</a>
  <p>Generated by <a href="https://ruby.github.io/rdoc/">RDoc</a> 6.4.0.
  <p>Based on <a href="http://deveiate.org/projects/Darkfish-RDoc/">Darkfish</a> by <a href="http://deveiate.org">Michael Granger</a>.
</footer>

